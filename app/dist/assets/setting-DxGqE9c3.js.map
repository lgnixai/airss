{"version":3,"file":"setting-DxGqE9c3.js","sources":["../../../esm/services/setting.js"],"sourcesContent":["var __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __decorateClass = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp(target, key, result);\n  return result;\n};\nvar __decorateParam = (index, decorator) => (target, key) => decorator(target, key, index);\nimport { BaseService } from \"../glue\";\nimport { SettingModel, SettingsEvent } from \"../models/setting\";\nimport { inject, injectable } from \"tsyringe\";\nlet SettingsService = class extends BaseService {\n  constructor(builtin, locale, colorTheme, editor) {\n    super(\"setting\");\n    this.builtin = builtin;\n    this.locale = locale;\n    this.colorTheme = colorTheme;\n    this.editor = editor;\n    this.state = new SettingModel();\n  }\n  state;\n  has(name) {\n    return Object.hasOwn(this.state.data, name);\n  }\n  getAll() {\n    return this.getState().data;\n  }\n  get(name) {\n    return this.state.data[name];\n  }\n  update(next) {\n    this.dispatch((draft) => {\n      Object.assign(draft.data, next);\n    });\n  }\n  remove(name) {\n    this.dispatch((draft) => {\n      if (Object.hasOwn(draft.data, name)) {\n        delete draft.data[name];\n      }\n    });\n  }\n  access() {\n    const { EDITOR_ITEM_SETTING: SETTING_ID } = this.builtin.getState().constants;\n    const settings = {\n      locale: this.locale.getState().current,\n      colorTheme: this.colorTheme.getState().current,\n      ...this.getAll()\n    };\n    const { current } = this.editor.getState();\n    if (!current || !this.editor.getTab(SETTING_ID, current)) {\n      this.editor.open(\n        {\n          id: SETTING_ID,\n          name: this.locale.localize(\"activityBar.item.setting\", \"Settings\"),\n          icon: \"file\",\n          value: JSON.stringify(settings, null, 4),\n          language: \"json\"\n        },\n        current\n      );\n    } else {\n      this.editor.setCurrent(SETTING_ID, current);\n    }\n  }\n  // ===================== Subscriptions =====================\n  onChange(callback) {\n    this.subscribe(SettingsEvent.OnChange, callback);\n  }\n};\nSettingsService = __decorateClass([\n  injectable(),\n  __decorateParam(0, inject(\"builtin\")),\n  __decorateParam(1, inject(\"locale\")),\n  __decorateParam(2, inject(\"colorTheme\")),\n  __decorateParam(3, inject(\"editor\"))\n], SettingsService);\nexport {\n  SettingsService\n};\n"],"names":["__getOwnPropDesc","__decorateClass","decorators","target","key","kind","result","i","decorator","__decorateParam","index","SettingsService","BaseService","builtin","locale","colorTheme","editor","SettingModel","name","next","draft","SETTING_ID","settings","current","callback","SettingsEvent","injectable","inject"],"mappings":"oLACA,IAAIA,EAAmB,OAAO,yBAC1BC,EAAkB,CAACC,EAAYC,EAAQC,EAAKC,IAAS,CAEvD,QADIC,EAASD,EAAO,EAAI,OAASA,EAAOL,EAAiBG,EAAQC,CAAG,EAAID,EAC/DI,EAAIL,EAAW,OAAS,EAAGM,EAAWD,GAAK,EAAGA,KACjDC,EAAYN,EAAWK,CAAC,KAC1BD,EAAkDE,EAAUF,CAAM,GAAMA,GAG5E,OAAOA,CACT,EACIG,EAAkB,CAACC,EAAOF,IAAc,CAACL,EAAQC,IAAQI,EAAUL,EAAQC,EAAKM,CAAK,EAItF,IAACC,EAAkB,cAAcC,CAAY,CAC9C,YAAYC,EAASC,EAAQC,EAAYC,EAAQ,CAC/C,MAAM,SAAS,EACf,KAAK,QAAUH,EACf,KAAK,OAASC,EACd,KAAK,WAAaC,EAClB,KAAK,OAASC,EACd,KAAK,MAAQ,IAAIC,CACnB,CACA,MACA,IAAIC,EAAM,CACR,OAAO,OAAO,OAAO,KAAK,MAAM,KAAMA,CAAI,CAC5C,CACA,QAAS,CACP,OAAO,KAAK,SAAQ,EAAG,IACzB,CACA,IAAIA,EAAM,CACR,OAAO,KAAK,MAAM,KAAKA,CAAI,CAC7B,CACA,OAAOC,EAAM,CACX,KAAK,SAAUC,GAAU,CACvB,OAAO,OAAOA,EAAM,KAAMD,CAAI,CAChC,CAAC,CACH,CACA,OAAOD,EAAM,CACX,KAAK,SAAUE,GAAU,CACnB,OAAO,OAAOA,EAAM,KAAMF,CAAI,GAChC,OAAOE,EAAM,KAAKF,CAAI,CAE1B,CAAC,CACH,CACA,QAAS,CACP,KAAM,CAAE,oBAAqBG,CAAU,EAAK,KAAK,QAAQ,SAAQ,EAAG,UAC9DC,EAAW,CACf,OAAQ,KAAK,OAAO,SAAQ,EAAG,QAC/B,WAAY,KAAK,WAAW,SAAQ,EAAG,QACvC,GAAG,KAAK,OAAM,CACpB,EACU,CAAE,QAAAC,CAAO,EAAK,KAAK,OAAO,SAAQ,EACpC,CAACA,GAAW,CAAC,KAAK,OAAO,OAAOF,EAAYE,CAAO,EACrD,KAAK,OAAO,KACV,CACE,GAAIF,EACJ,KAAM,KAAK,OAAO,SAAS,2BAA4B,UAAU,EACjE,KAAM,OACN,MAAO,KAAK,UAAUC,EAAU,KAAM,CAAC,EACvC,SAAU,MACpB,EACQC,CACR,EAEM,KAAK,OAAO,WAAWF,EAAYE,CAAO,CAE9C,CAEA,SAASC,EAAU,CACjB,KAAK,UAAUC,EAAc,SAAUD,CAAQ,CACjD,CACF,EACAb,EAAkBV,EAAgB,CAChCyB,EAAU,EACVjB,EAAgB,EAAGkB,EAAO,SAAS,CAAC,EACpClB,EAAgB,EAAGkB,EAAO,QAAQ,CAAC,EACnClB,EAAgB,EAAGkB,EAAO,YAAY,CAAC,EACvClB,EAAgB,EAAGkB,EAAO,QAAQ,CAAC,CACrC,EAAGhB,CAAe"}