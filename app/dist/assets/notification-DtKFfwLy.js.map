{"version":3,"file":"notification-DtKFfwLy.js","sources":["../../../esm/services/notification.js"],"sourcesContent":["import { BaseService } from \"../glue\";\nimport { NotificationEvent, NotificationModel, NotificationStatus } from \"../models/notification\";\nimport { arraylize, searchById } from \"../utils\";\nclass NotificationService extends BaseService {\n  state;\n  constructor() {\n    super(\"notification\");\n    this.state = new NotificationModel();\n  }\n  get(id) {\n    return this.getState().data.find(searchById(id));\n  }\n  update(item, predict) {\n    this.dispatch((draft) => {\n      const target = draft.data.find(searchById(typeof item === \"object\" ? item.id : item));\n      if (!target)\n        return;\n      Object.assign(target, typeof item === \"object\" ? item : predict?.(target));\n    });\n  }\n  remove(id) {\n    this.dispatch((draft) => {\n      const idx = draft.data.findIndex(searchById(id));\n      if (idx === -1)\n        return;\n      draft.data.splice(idx, 1);\n    });\n    this.close(id);\n  }\n  open(items) {\n    this.add(items);\n    this.dispatch((draft) => {\n      draft.toasts.push(items.id);\n    });\n  }\n  close(id) {\n    this.dispatch((draft) => {\n      const idx = draft.toasts.indexOf(id);\n      if (idx === -1)\n        return;\n      draft.toasts.splice(idx, 1);\n    });\n  }\n  closeAll() {\n    this.dispatch((draft) => {\n      draft.toasts.length = 0;\n    });\n  }\n  add(item) {\n    this.dispatch((draft) => {\n      const nextItems = arraylize(item).map((item2) => ({\n        ...item2,\n        status: NotificationStatus.WaitRead\n      }));\n      draft.data.push(...nextItems);\n    });\n  }\n  addToolbar(item) {\n    this.dispatch((draft) => {\n      draft.toolbar.push(...arraylize(item));\n    });\n  }\n  clear() {\n    this.dispatch((draft) => {\n      draft.data.length = 0;\n    });\n  }\n  reset() {\n    this.setState(new NotificationModel());\n  }\n  // ===================== Subscriptions =====================\n  onCloseNotification(callback) {\n    this.subscribe(NotificationEvent.onCloseNotification, callback);\n  }\n  onClick = (callback) => {\n    this.subscribe(NotificationEvent.onClick, callback);\n  };\n  onClickItem = (callback) => {\n    this.subscribe(NotificationEvent.onClickItem, callback);\n  };\n  onKeyPress = (callback) => {\n    this.subscribe(NotificationEvent.onKeyPress, callback);\n  };\n  onActionBarClick = (callback) => {\n    this.subscribe(NotificationEvent.onActionBarClick, callback);\n  };\n}\nexport {\n  NotificationService\n};\n"],"names":["NotificationService","BaseService","NotificationModel","id","searchById","item","predict","draft","target","idx","items","nextItems","arraylize","item2","NotificationStatus","callback","NotificationEvent"],"mappings":"0LAGA,MAAMA,UAA4BC,CAAY,CAC5C,MACA,aAAc,CACZ,MAAM,cAAc,EACpB,KAAK,MAAQ,IAAIC,CACnB,CACA,IAAIC,EAAI,CACN,OAAO,KAAK,WAAW,KAAK,KAAKC,EAAWD,CAAE,CAAC,CACjD,CACA,OAAOE,EAAMC,EAAS,CACpB,KAAK,SAAUC,GAAU,CACvB,MAAMC,EAASD,EAAM,KAAK,KAAKH,EAAW,OAAOC,GAAS,SAAWA,EAAK,GAAKA,CAAI,CAAC,EAC/EG,GAEL,OAAO,OAAOA,EAAQ,OAAOH,GAAS,SAAWA,EAAOC,IAAUE,CAAM,CAAC,CAC3E,CAAC,CACH,CACA,OAAOL,EAAI,CACT,KAAK,SAAUI,GAAU,CACvB,MAAME,EAAMF,EAAM,KAAK,UAAUH,EAAWD,CAAE,CAAC,EAC3CM,IAAQ,IAEZF,EAAM,KAAK,OAAOE,EAAK,CAAC,CAC1B,CAAC,EACD,KAAK,MAAMN,CAAE,CACf,CACA,KAAKO,EAAO,CACV,KAAK,IAAIA,CAAK,EACd,KAAK,SAAUH,GAAU,CACvBA,EAAM,OAAO,KAAKG,EAAM,EAAE,CAC5B,CAAC,CACH,CACA,MAAMP,EAAI,CACR,KAAK,SAAUI,GAAU,CACvB,MAAME,EAAMF,EAAM,OAAO,QAAQJ,CAAE,EAC/BM,IAAQ,IAEZF,EAAM,OAAO,OAAOE,EAAK,CAAC,CAC5B,CAAC,CACH,CACA,UAAW,CACT,KAAK,SAAUF,GAAU,CACvBA,EAAM,OAAO,OAAS,CACxB,CAAC,CACH,CACA,IAAIF,EAAM,CACR,KAAK,SAAUE,GAAU,CACvB,MAAMI,EAAYC,EAAUP,CAAI,EAAE,IAAKQ,IAAW,CAChD,GAAGA,EACH,OAAQC,EAAmB,QACnC,EAAQ,EACFP,EAAM,KAAK,KAAK,GAAGI,CAAS,CAC9B,CAAC,CACH,CACA,WAAWN,EAAM,CACf,KAAK,SAAUE,GAAU,CACvBA,EAAM,QAAQ,KAAK,GAAGK,EAAUP,CAAI,CAAC,CACvC,CAAC,CACH,CACA,OAAQ,CACN,KAAK,SAAUE,GAAU,CACvBA,EAAM,KAAK,OAAS,CACtB,CAAC,CACH,CACA,OAAQ,CACN,KAAK,SAAS,IAAIL,CAAmB,CACvC,CAEA,oBAAoBa,EAAU,CAC5B,KAAK,UAAUC,EAAkB,oBAAqBD,CAAQ,CAChE,CACA,QAAWA,GAAa,CACtB,KAAK,UAAUC,EAAkB,QAASD,CAAQ,CACpD,EACA,YAAeA,GAAa,CAC1B,KAAK,UAAUC,EAAkB,YAAaD,CAAQ,CACxD,EACA,WAAcA,GAAa,CACzB,KAAK,UAAUC,EAAkB,WAAYD,CAAQ,CACvD,EACA,iBAAoBA,GAAa,CAC/B,KAAK,UAAUC,EAAkB,iBAAkBD,CAAQ,CAC7D,CACF"}