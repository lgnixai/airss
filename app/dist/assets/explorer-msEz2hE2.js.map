{"version":3,"file":"explorer-msEz2hE2.js","sources":["../../../esm/services/explorer.js"],"sourcesContent":["import { BaseService } from \"../glue\";\nimport { ExplorerEvent, ExplorerModel } from \"../models/explorer\";\nimport { arraylize, searchById } from \"../utils\";\nclass ExplorerService extends BaseService {\n  state;\n  constructor() {\n    super(\"explorer\");\n    this.state = new ExplorerModel();\n  }\n  get(id) {\n    return this.getAll().find(searchById(id));\n  }\n  getAll() {\n    return this.getState().data;\n  }\n  getActive() {\n    return this.getState().active;\n  }\n  setActive(active) {\n    this.dispatch((draft) => {\n      draft.active = active;\n    });\n  }\n  toggleActive(panelId) {\n    this.dispatch((draft) => {\n      const idx = draft.active.findIndex((id) => id === panelId);\n      if (idx === -1)\n        draft.active.push(panelId);\n      else\n        draft.active.splice(idx, 1);\n    });\n  }\n  update(item, predict) {\n    if (typeof item === \"object\") {\n      this.dispatch((draft) => {\n        const target = draft.data.find(searchById(item.id));\n        if (!target)\n          return;\n        Object.assign(target, item);\n      });\n    } else {\n      this.dispatch((draft) => {\n        const target = draft.data.find(searchById(item));\n        if (!target)\n          return;\n        Object.assign(target, predict?.(target));\n      });\n    }\n  }\n  add(data) {\n    this.dispatch((draft) => {\n      draft.data.push(...arraylize(data));\n    });\n  }\n  addToolbar(id, toolbars) {\n    this.dispatch((draft) => {\n      const idx = draft.data.findIndex(searchById(id));\n      if (idx === -1)\n        return;\n      draft.data[idx].toolbar ??= [];\n      draft.data[idx].toolbar?.push(...arraylize(toolbars));\n    });\n  }\n  remove(id) {\n    this.dispatch((draft) => {\n      const idx = draft.data.findIndex(searchById(id));\n      if (idx === -1)\n        return;\n      draft.data.splice(idx, 1);\n    });\n  }\n  removeToolbar(id, itemOrFunc) {\n    this.dispatch((draft) => {\n      const idx = draft.data.findIndex(searchById(id));\n      if (idx === -1)\n        return;\n      if (typeof itemOrFunc === \"function\") {\n        draft.data[idx].toolbar = draft.data[idx].toolbar?.filter(itemOrFunc);\n      } else {\n        draft.data[idx].toolbar = draft.data[idx].toolbar?.filter((item) => !itemOrFunc.includes(item.id));\n      }\n    });\n  }\n  togglePanel(id, hidden) {\n    this.update(id, (prev) => ({\n      hidden: typeof hidden === \"boolean\" ? hidden : !prev.hidden\n    }));\n  }\n  reset() {\n    this.setState(new ExplorerModel());\n  }\n  // ===================== Subscriptions =====================\n  onPanelToolbarClick(callback) {\n    this.subscribe(ExplorerEvent.onPanelToolbarClick, callback);\n  }\n  onCollapseChange(callback) {\n    this.subscribe(ExplorerEvent.onCollapseChange, callback);\n  }\n  onContextMenu(callback) {\n    this.subscribe(ExplorerEvent.onContextMenu, callback);\n  }\n}\nexport {\n  ExplorerService\n};\n"],"names":["ExplorerService","BaseService","ExplorerModel","id","searchById","active","draft","panelId","idx","item","predict","target","data","arraylize","toolbars","itemOrFunc","hidden","prev","callback","ExplorerEvent"],"mappings":"6KAGA,MAAMA,UAAwBC,CAAY,CACxC,MACA,aAAc,CACZ,MAAM,UAAU,EAChB,KAAK,MAAQ,IAAIC,CACnB,CACA,IAAIC,EAAI,CACN,OAAO,KAAK,OAAM,EAAG,KAAKC,EAAWD,CAAE,CAAC,CAC1C,CACA,QAAS,CACP,OAAO,KAAK,SAAQ,EAAG,IACzB,CACA,WAAY,CACV,OAAO,KAAK,SAAQ,EAAG,MACzB,CACA,UAAUE,EAAQ,CAChB,KAAK,SAAUC,GAAU,CACvBA,EAAM,OAASD,CACjB,CAAC,CACH,CACA,aAAaE,EAAS,CACpB,KAAK,SAAUD,GAAU,CACvB,MAAME,EAAMF,EAAM,OAAO,UAAWH,GAAOA,IAAOI,CAAO,EACrDC,IAAQ,GACVF,EAAM,OAAO,KAAKC,CAAO,EAEzBD,EAAM,OAAO,OAAOE,EAAK,CAAC,CAC9B,CAAC,CACH,CACA,OAAOC,EAAMC,EAAS,CAChB,OAAOD,GAAS,SAClB,KAAK,SAAUH,GAAU,CACvB,MAAMK,EAASL,EAAM,KAAK,KAAKF,EAAWK,EAAK,EAAE,CAAC,EAC7CE,GAEL,OAAO,OAAOA,EAAQF,CAAI,CAC5B,CAAC,EAED,KAAK,SAAUH,GAAU,CACvB,MAAMK,EAASL,EAAM,KAAK,KAAKF,EAAWK,CAAI,CAAC,EAC1CE,GAEL,OAAO,OAAOA,EAAQD,IAAUC,CAAM,CAAC,CACzC,CAAC,CAEL,CACA,IAAIC,EAAM,CACR,KAAK,SAAUN,GAAU,CACvBA,EAAM,KAAK,KAAK,GAAGO,EAAUD,CAAI,CAAC,CACpC,CAAC,CACH,CACA,WAAWT,EAAIW,EAAU,CACvB,KAAK,SAAUR,GAAU,CACvB,MAAME,EAAMF,EAAM,KAAK,UAAUF,EAAWD,CAAE,CAAC,EAC3CK,IAAQ,KAEZF,EAAM,KAAKE,CAAG,EAAE,UAAY,CAAA,EAC5BF,EAAM,KAAKE,CAAG,EAAE,SAAS,KAAK,GAAGK,EAAUC,CAAQ,CAAC,EACtD,CAAC,CACH,CACA,OAAOX,EAAI,CACT,KAAK,SAAUG,GAAU,CACvB,MAAME,EAAMF,EAAM,KAAK,UAAUF,EAAWD,CAAE,CAAC,EAC3CK,IAAQ,IAEZF,EAAM,KAAK,OAAOE,EAAK,CAAC,CAC1B,CAAC,CACH,CACA,cAAcL,EAAIY,EAAY,CAC5B,KAAK,SAAUT,GAAU,CACvB,MAAME,EAAMF,EAAM,KAAK,UAAUF,EAAWD,CAAE,CAAC,EAC3CK,IAAQ,KAER,OAAOO,GAAe,WACxBT,EAAM,KAAKE,CAAG,EAAE,QAAUF,EAAM,KAAKE,CAAG,EAAE,SAAS,OAAOO,CAAU,EAEpET,EAAM,KAAKE,CAAG,EAAE,QAAUF,EAAM,KAAKE,CAAG,EAAE,SAAS,OAAQC,GAAS,CAACM,EAAW,SAASN,EAAK,EAAE,CAAC,EAErG,CAAC,CACH,CACA,YAAYN,EAAIa,EAAQ,CACtB,KAAK,OAAOb,EAAKc,IAAU,CACzB,OAAQ,OAAOD,GAAW,UAAYA,EAAS,CAACC,EAAK,MAC3D,EAAM,CACJ,CACA,OAAQ,CACN,KAAK,SAAS,IAAIf,CAAe,CACnC,CAEA,oBAAoBgB,EAAU,CAC5B,KAAK,UAAUC,EAAc,oBAAqBD,CAAQ,CAC5D,CACA,iBAAiBA,EAAU,CACzB,KAAK,UAAUC,EAAc,iBAAkBD,CAAQ,CACzD,CACA,cAAcA,EAAU,CACtB,KAAK,UAAUC,EAAc,cAAeD,CAAQ,CACtD,CACF"}