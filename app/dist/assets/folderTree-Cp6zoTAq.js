import{F as c,T as d,w as p,s as u,x as r,i as g}from"./index-Cz3doEcl.js";import{B as b}from"./baseService-IKxxVQs3.js";import{i as a}from"./isUndefined-DCTLXrZ8.js";import"./react-vendor-Bs7gn1Hv.js";import"./monaco-vendor-Dv-Uvxl1.js";var f=Object.getOwnPropertyDescriptor,x=(e,t,n,i)=>{for(var s=i>1?void 0:i?f(t,n):t,o=e.length-1,h;o>=0;o--)(h=e[o])&&(s=h(s)||s);return s};let l=class extends b{state;constructor(){super("folderTree"),this.state=new c}addLoading(e){this.dispatch(t=>{t.loadingKeys.push(e)})}removeLoading(e){this.dispatch(t=>{if(a(e)){t.loadingKeys=[];return}const n=t.loadingKeys.indexOf(e);n!==-1&&t.loadingKeys.splice(n,1)})}get(e){return this.getState().data.length?new d(this.getState().data).getNode(e):void 0}getParentNode(e){return this.getState().data.length?new d(this.getState().data).getParent(e):void 0}addRootFolder(e){this.dispatch(t=>{t.data?.length||(t.data=[e])})}add(e,t){if(e.fileType===p.RootFolder){this.addRootFolder(e);return}if(a(t))throw new Error("File node or folder node both need id");this.dispatch(i=>{const o=new d(i.data).getNode(t);o&&(o.children??=[],o.children.push(e))})}remove(e){this.dispatch(t=>{const i=new d(t.data).getParent(e),s=i?.children?.findIndex(u(e));s===void 0||s===-1||i?.children?.splice(s,1)})}update(e,t){this.dispatch(n=>{const s=new d(n.data).getNode(typeof e=="object"?e.id:e);s&&Object.assign(s,typeof e=="object"?e:t?.(s))}),this.emit(r.onUpdate,this.get(typeof e=="object"?e.id:e))}drop(e,t){const n=this.get(e);if(!n)return;const i=this.get(t);!i||i.fileType===p.File||(this.remove(e),this.add(n,i.id))}setCurrent(e){this.emit(r.onCurrentChange,this.getCurrent(),e),this.dispatch(t=>{t.current=e})}getCurrent(){return this.getState().current}getExpanded(){return this.getState().expandedKeys}addExpanded(e){this.dispatch(t=>{t.expandedKeys.push(e)})}removeExpanded(e){this.dispatch(t=>{if(a(e)){t.expandedKeys=[];return}const n=t.expandedKeys.indexOf(e);n!==-1&&t.expandedKeys.splice(n,1)})}toggleExpanded(e){this.getExpanded().includes(e)?this.removeExpanded(e):this.addExpanded(e)}setValidateInfo(e){this.dispatch(t=>{t.validateInfo=typeof e=="string"?{status:"info",message:e}:e})}setEntry(e){this.dispatch(t=>{t.entry=e})}setEditing(e){this.dispatch(t=>{t.editing=e})}reset(){this.setState(new c)}onRename(e){this.subscribe(r.onRename,e)}onRemove(e){this.subscribe(r.onDelete,e)}onSelect(e){this.subscribe(r.onSelect,e)}onContextMenu=e=>{this.subscribe(r.onContextMenu,e)};onContextMenuClick(e){this.subscribe(r.onContextMenuClick,e)}onExpand=e=>{this.subscribe(r.onExpand,e)};onKeyDown(e){this.subscribe(r.onKeyDown,e)}onCreateRoot(e){this.subscribe(r.onCreateRoot,e)}onUpdate(e){this.subscribe(r.onUpdate,e)}onBlur(e){this.subscribe(r.onBlur,e)}onLoad(e){this.subscribe(r.onLoad,e)}onDragStart(e){this.subscribe(r.onDragStart,e)}onDragOver=e=>{this.subscribe(r.onDragOver,e)};onDragEnd(e){this.subscribe(r.onDragEnd,e)}onDrop=e=>{this.subscribe(r.onDrop,e)};onCurrentChange(e){this.subscribe(r.onCurrentChange,e)}};l=x([g()],l);export{l as FolderTreeService};
//# sourceMappingURL=folderTree-Cp6zoTAq.js.map
