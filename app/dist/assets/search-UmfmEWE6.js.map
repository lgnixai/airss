{"version":3,"file":"search-UmfmEWE6.js","sources":["../../../esm/services/search.js"],"sourcesContent":["var __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __decorateClass = (decorators, target, key, kind) => {\n  var result = kind > 1 ? void 0 : kind ? __getOwnPropDesc(target, key) : target;\n  for (var i = decorators.length - 1, decorator; i >= 0; i--)\n    if (decorator = decorators[i])\n      result = (kind ? decorator(target, key, result) : decorator(result)) || result;\n  if (kind && result)\n    __defProp(target, key, result);\n  return result;\n};\nimport { BaseService } from \"../glue\";\nimport { SearchEvent, SearchModel } from \"../models/search\";\nimport {\n  SearchMode\n} from \"../types\";\nimport { arraylize } from \"../utils\";\nimport { injectable } from \"tsyringe\";\nlet SearchService = class extends BaseService {\n  state;\n  constructor() {\n    super(\"search\");\n    this.state = new SearchModel();\n  }\n  getValue() {\n    return this.getState().value;\n  }\n  getExpandedKeys() {\n    return this.getState().expandedKeys;\n  }\n  getMode() {\n    return this.getState().mode;\n  }\n  setValue(value) {\n    this.dispatch((draft) => {\n      draft.value = value;\n    });\n  }\n  setValidateInfo(message) {\n    this.dispatch((draft) => {\n      draft.validateInfo = typeof message === \"string\" ? { status: \"info\", message } : message;\n    });\n  }\n  setMode(mode) {\n    this.dispatch((draft) => {\n      draft.mode = mode;\n    });\n  }\n  toggleMode(mode) {\n    const next = mode || (this.getMode() === SearchMode.list ? SearchMode.tree : SearchMode.list);\n    this.setMode(next);\n  }\n  setResult(data, total) {\n    this.dispatch((draft) => {\n      draft.result = {\n        total,\n        results: data\n      };\n    });\n  }\n  setExpandedKeys(expandedKeys) {\n    this.dispatch((draft) => {\n      draft.expandedKeys = expandedKeys;\n    });\n  }\n  expandAll() {\n    this.dispatch((draft) => {\n      const expandedKeys = draft.result.results.map((item) => item.filename);\n      draft.expandedKeys = expandedKeys;\n    });\n  }\n  addExpandedKeys(expandedKeys) {\n    this.dispatch((draft) => {\n      draft.expandedKeys.push(...arraylize(expandedKeys));\n    });\n  }\n  removeExpandedKeys(expandedKey) {\n    this.dispatch((draft) => {\n      arraylize(expandedKey).forEach((key) => {\n        const idx = draft.expandedKeys.indexOf(key);\n        if (idx === -1)\n          return;\n        draft.expandedKeys.splice(idx, 1);\n      });\n    });\n  }\n  // public toggleExpandedKey(expandedKey: UniqueId) {\n  //     if (this.getExpandedKeys().includes(expandedKey)) {\n  //         this.removeExpandedKeys(expandedKey);\n  //     } else {\n  //         this.addExpandedKeys(expandedKey);\n  //     }\n  // }\n  reset() {\n    this.setState(new SearchModel());\n  }\n  // ===================== Subscriptions =====================\n  onChange(callback) {\n    this.subscribe(SearchEvent.onChange, callback);\n  }\n  onSearch(callback) {\n    this.subscribe(SearchEvent.onSearch, callback);\n  }\n  onSelect(callback) {\n    this.subscribe(SearchEvent.onSelect, callback);\n  }\n  onEnter(callback) {\n    this.subscribe(SearchEvent.onEnter, callback);\n  }\n};\nSearchService = __decorateClass([\n  injectable()\n], SearchService);\nexport {\n  SearchService\n};\n"],"names":["__getOwnPropDesc","__decorateClass","decorators","target","key","kind","result","i","decorator","SearchService","BaseService","SearchModel","value","draft","message","mode","next","SearchMode","data","total","expandedKeys","item","arraylize","expandedKey","idx","callback","SearchEvent","injectable"],"mappings":"4LACA,IAAIA,EAAmB,OAAO,yBAC1BC,EAAkB,CAACC,EAAYC,EAAQC,EAAKC,IAAS,CAEvD,QADIC,EAASD,EAAO,EAAI,OAASA,EAAOL,EAAiBG,EAAQC,CAAG,EAAID,EAC/DI,EAAIL,EAAW,OAAS,EAAGM,EAAWD,GAAK,EAAGA,KACjDC,EAAYN,EAAWK,CAAC,KAC1BD,EAAkDE,EAAUF,CAAM,GAAMA,GAG5E,OAAOA,CACT,EAQG,IAACG,EAAgB,cAAcC,CAAY,CAC5C,MACA,aAAc,CACZ,MAAM,QAAQ,EACd,KAAK,MAAQ,IAAIC,CACnB,CACA,UAAW,CACT,OAAO,KAAK,SAAQ,EAAG,KACzB,CACA,iBAAkB,CAChB,OAAO,KAAK,SAAQ,EAAG,YACzB,CACA,SAAU,CACR,OAAO,KAAK,SAAQ,EAAG,IACzB,CACA,SAASC,EAAO,CACd,KAAK,SAAUC,GAAU,CACvBA,EAAM,MAAQD,CAChB,CAAC,CACH,CACA,gBAAgBE,EAAS,CACvB,KAAK,SAAUD,GAAU,CACvBA,EAAM,aAAe,OAAOC,GAAY,SAAW,CAAE,OAAQ,OAAQ,QAAAA,CAAO,EAAKA,CACnF,CAAC,CACH,CACA,QAAQC,EAAM,CACZ,KAAK,SAAUF,GAAU,CACvBA,EAAM,KAAOE,CACf,CAAC,CACH,CACA,WAAWA,EAAM,CACf,MAAMC,EAAOD,IAAS,KAAK,QAAO,IAAOE,EAAW,KAAOA,EAAW,KAAOA,EAAW,MACxF,KAAK,QAAQD,CAAI,CACnB,CACA,UAAUE,EAAMC,EAAO,CACrB,KAAK,SAAUN,GAAU,CACvBA,EAAM,OAAS,CACb,MAAAM,EACA,QAASD,CACjB,CACI,CAAC,CACH,CACA,gBAAgBE,EAAc,CAC5B,KAAK,SAAUP,GAAU,CACvBA,EAAM,aAAeO,CACvB,CAAC,CACH,CACA,WAAY,CACV,KAAK,SAAUP,GAAU,CACvB,MAAMO,EAAeP,EAAM,OAAO,QAAQ,IAAKQ,GAASA,EAAK,QAAQ,EACrER,EAAM,aAAeO,CACvB,CAAC,CACH,CACA,gBAAgBA,EAAc,CAC5B,KAAK,SAAUP,GAAU,CACvBA,EAAM,aAAa,KAAK,GAAGS,EAAUF,CAAY,CAAC,CACpD,CAAC,CACH,CACA,mBAAmBG,EAAa,CAC9B,KAAK,SAAUV,GAAU,CACvBS,EAAUC,CAAW,EAAE,QAASnB,GAAQ,CACtC,MAAMoB,EAAMX,EAAM,aAAa,QAAQT,CAAG,EACtCoB,IAAQ,IAEZX,EAAM,aAAa,OAAOW,EAAK,CAAC,CAClC,CAAC,CACH,CAAC,CACH,CAQA,OAAQ,CACN,KAAK,SAAS,IAAIb,CAAa,CACjC,CAEA,SAASc,EAAU,CACjB,KAAK,UAAUC,EAAY,SAAUD,CAAQ,CAC/C,CACA,SAASA,EAAU,CACjB,KAAK,UAAUC,EAAY,SAAUD,CAAQ,CAC/C,CACA,SAASA,EAAU,CACjB,KAAK,UAAUC,EAAY,SAAUD,CAAQ,CAC/C,CACA,QAAQA,EAAU,CAChB,KAAK,UAAUC,EAAY,QAASD,CAAQ,CAC9C,CACF,EACAhB,EAAgBR,EAAgB,CAC9B0B,EAAU,CACZ,EAAGlB,CAAa"}