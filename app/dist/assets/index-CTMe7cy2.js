import{aw as a,aN as S,at as w,av as C,au as A,a4 as F,a$ as K,b0 as p,w as x,aP as P,b1 as O,b2 as H,b3 as z}from"./index-Cz3doEcl.js";import"./react-vendor-Bs7gn1Hv.js";import"./monaco-vendor-Dv-Uvxl1.js";const T={text:"mo-text",active:"mo-text--match"};function B({highlight:u,children:l}){if(!u)return a.jsx(a.Fragment,{children:l});let i=0,c=l.toLocaleLowerCase().indexOf(u.toLocaleLowerCase(),i);const o=[];for(;c!==-1&&o.length<=4;)o.push(a.jsx(a.Fragment,{children:l.toLocaleLowerCase().substring(i,c)})),o.push(a.jsx("span",{className:S(T.text,T.active),children:l.substring(c,c+u.length)})),i=c,c=l.toLocaleLowerCase().indexOf(u.toLocaleLowerCase(),i+1);return i&&o.push(a.jsx(a.Fragment,{children:l.substring(i+u.length)})),a.jsx(a.Fragment,{children:o.map((s,h)=>a.jsx(w.Fragment,{children:s},h))})}const j={container:"mo-search",widget:"mo-search__widget",result:"mo-search__result",tip:"mo-search__tip"};function q({onChange:u,onSearch:l,onEnter:i,onSelect:c}){const o=C("builtin"),s=C("search"),h=A(),E=h(o.constants.SIDEBAR_ITEM_SEARCH,"Search"),[D,N]=w.useTransition(),M=e=>{N(()=>{u?.(e),l?.(e)})},y=()=>{if(!s.value)return null;if(!s.result.total)return h(o.constants.SEARCH_ITEM_NOT_FOUND,"No results found.");const e=s.result.results.reduce((t,n)=>(t.add(n.filename),t),new Set).size;return h(o.constants.SEARCH_ITEM_RESULT_TIP,"",s.result.total,e)},_=w.useMemo(()=>{if(!s.result.total)return[];if(s.mode===F.list)return s.result.results.reduce((e,t)=>{const n=K(e,r=>r.id===t.filename,new p(t.filename,t.filename,x.Folder,[],t.icon,void 0));return n.children??=[],n.children.push(new p(t.id,t.data||"",x.File,void 0,void 0,t.disabled,t)),e},[]);{const e=new Map,t=[];return s.result.results.forEach(n=>{if(!e.has(n.filename)){const d=n.filename.split("/");d.forEach((m,g)=>{if(g===0){if(!e.has(m)){const f=new p(m,m,x.Folder,[]);e.set(m,f),t.push(f)}}else{const f=d.slice(0,g+1).join("/"),R=d.slice(0,g).join("/");if(!e.has(f)){const L=e.get(R);if(!L)return;L.children??=[];const v=new p(f,m,x.Folder,[]);e.set(f,v),L.children.push(v)}}})}const r=e.get(n.filename);r&&(r.icon=n.icon,r.children??=[],r.children.push(new p(n.id,n.data||"",x.File,void 0,void 0,n.disabled,n)))}),t}},[s.mode,s.result.total,s.result.results]),b=w.useMemo(()=>s.result.total?s.mode===F.list?s.expandedKeys:Array.from(s.expandedKeys.reduce((e,t)=>{const n=t.split("/");return n.forEach((r,d)=>{const m=n.slice(0,d+1).join("/");e.add(m)}),e},new Set)):[],[s.mode,s.result.total,s.expandedKeys]),I=w.useMemo(()=>a.jsxs(a.Fragment,{children:[a.jsx("span",{className:j.tip,children:y()}),a.jsx(P,{isShowShadow:!0,children:a.jsx(O,{className:j.result,expandedKeys:b,data:_,onSelect:c,draggable:!1,renderTitle:e=>{if(e.fileType==="File"){const t=s.value,r=e.name.split(`
`).find(d=>d.toLocaleLowerCase().includes(t.toLocaleLowerCase()));return r?a.jsx("span",{title:e.name,children:a.jsx(B,{highlight:t,children:H(r,t)})}):e.name}return e.name}})})]}),[b,_]);return a.jsxs("section",{className:j.container,children:[a.jsx(z,{autoFocus:!0,value:s.value,className:S(j.widget),info:s.validateInfo,placeholder:E,onChange:M,onSubmit:i}),I]})}export{q as default};
//# sourceMappingURL=index-CTMe7cy2.js.map
